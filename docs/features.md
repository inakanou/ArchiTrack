# ArchiTrack 機能一覧

このドキュメントでは、ArchiTrackの実装済み機能と開発予定機能の詳細を説明します。

---

## 現在実装済み

### インフラストラクチャ

- ✅ **ヘルスチェックAPI**
  - システムの稼働状態を監視するためのエンドポイント
  - データベース、Redis、アプリケーションサーバーの状態チェック

- ✅ **Swagger/OpenAPI仕様書自動生成**
  - API仕様を自動的にドキュメント化
  - 開発者向けのインタラクティブなAPI探索UI
  - エンドポイント: `http://localhost:3000/docs`

- ✅ **PostgreSQLデータベース統合**
  - Prisma ORMによる型安全なデータベースアクセス
  - マイグレーション管理とスキーマ定義

- ✅ **Redisキャッシング準備**
  - セッション管理、レート制限、キャッシング用のRedis統合
  - パフォーマンス最適化のためのインメモリストレージ

- ✅ **Sentry統合（エラー監視）**
  - 本番環境でのエラートラッキング
  - パフォーマンスモニタリング
  - リアルタイムアラート

- ✅ **E2Eテスト環境（Playwright）**
  - ブラウザベースの自動テスト
  - CI/CDパイプライン統合
  - スクリーンショット、ビデオ、トレース機能

### 認証・認可機能

#### ユーザー認証

- ✅ **JWT（EdDSA署名）ベースの認証**
  - Ed25519楕円曲線署名アルゴリズムによる安全なトークン
  - アクセストークン（15分有効期限）+ リフレッシュトークン（7日有効期限）
  - トークンローテーション対応

- ✅ **招待制ユーザー登録**
  - 管理者による招待トークン発行
  - トークンの有効期限管理（7日間）
  - ロール指定による初期権限設定

#### 二段階認証（2FA）

- ✅ **TOTP方式**
  - RFC 6238準拠の時間ベースワンタイムパスワード
  - Google Authenticator、Authy等のアプリ対応
  - 30秒周期、6桁コード

- ✅ **バックアップコード**
  - デバイス紛失時のリカバリー手段
  - 8桁 × 10個の使い捨てコード
  - 一度使用したコードは無効化

- ✅ **QRコード生成**
  - 認証アプリへの簡単な登録
  - Base64エンコードされたPNG画像
  - otpauth:// URIスキーム

#### パスワード管理

- ✅ **Argon2idハッシュ化**
  - メモリハード関数による強力なハッシュ化
  - ブルートフォース攻撃への高い耐性
  - PHC（Password Hashing Competition）優勝アルゴリズム

- ✅ **HIBP（Have I Been Pwned）漏洩チェック**
  - 登録・パスワード変更時に漏洩データベースをチェック
  - k-匿名性モデルによるプライバシー保護
  - 既知の漏洩パスワードを拒否

- ✅ **パスワード履歴管理**
  - 過去10回のパスワードを記録
  - パスワード再利用を防止
  - セキュリティ要件の強化

#### ロールベースアクセス制御（RBAC）

- ✅ **NIST RBAC標準準拠**
  - Core RBAC（基本的なロールと権限）
  - Hierarchical RBAC（ロールの階層構造）
  - Constrained RBAC（制約付きロール割り当て）

- ✅ **事前定義ロール**
  - `ADMIN`: システム管理者（全権限）
  - `EDITOR`: コンテンツ編集者（ADR作成・編集）
  - `VIEWER`: 閲覧者（読み取りのみ）

- ✅ **権限管理**
  - きめ細かい権限設定
  - ロールと権限の動的割り当て
  - 最小権限の原則（Principle of Least Privilege）

#### セッション管理

- ✅ **マルチデバイス対応**
  - 複数デバイスでの同時ログイン
  - デバイスごとのセッション追跡
  - User-Agent、IPアドレスの記録

- ✅ **全デバイスログアウト**
  - セキュリティ侵害時の緊急対応
  - 全セッションの一括無効化
  - リフレッシュトークンの完全削除

#### 監査ログ

- ✅ **センシティブな操作の完全記録**
  - ログイン/ログアウト
  - パスワード変更
  - 2FA設定変更
  - ロール変更
  - ユーザー招待
  - 監査ログ閲覧（管理者のみ）

- ✅ **詳細なコンテキスト記録**
  - タイムスタンプ（UTC）
  - ユーザー識別情報
  - IPアドレス
  - User-Agent
  - 操作結果（成功/失敗）
  - エラー詳細

---

## 開発予定

以下の機能は現在開発中、または今後の開発予定です。

### ADR管理機能（コア機能）

- 🚧 **ADR作成・編集・削除**
  - Markdownエディタによる記述
  - テンプレート選択
  - メタデータ管理（ステータス、タグ、関連ADR）

- 🚧 **ADRバージョン管理**
  - 変更履歴の追跡
  - 差分表示
  - 以前のバージョンへの復元

- 🚧 **ADR検索・フィルタリング**
  - 全文検索
  - タグによるフィルタリング
  - ステータスによる絞り込み
  - 日付範囲検索

### チーム機能

- 🚧 **チーム管理**
  - チーム作成・編集・削除
  - メンバー管理
  - チームごとのADR管理

### エディター機能

- 🚧 **Markdownエディタ**
  - リアルタイムプレビュー
  - シンタックスハイライト
  - 画像アップロード
  - コードブロック対応

### テンプレート機能

- 🚧 **ADRテンプレート管理**
  - カスタムテンプレート作成
  - テンプレートライブラリ
  - 組織標準テンプレート

---

## 関連ドキュメント

- [API概要](api/overview.md) - 各機能のAPIエンドポイント
- [セキュリティ設計](architecture/security-design.md) - 認証・認可の設計詳細
- [技術スタック](architecture/tech-stack.md) - 使用技術の選定理由
