# プロダクト概要

## ArchiTrackについて

ArchiTrackは、ソフトウェアプロジェクトにおけるアーキテクチャ決定記録（ADR: Architecture Decision Record）を効率的に管理するためのWebアプリケーションです。

Claude Codeを活用したKiro-style Spec Driven Development（スペック駆動開発）で開発されており、スラッシュコマンド、フック、エージェント機能を統合した体系的な開発ワークフローを実現しています。

_最終更新: 2026-01-11（Steering Sync: 数量表作成機能の追加）_

## コア機能

### 現在実装済み

- ✅ **ヘルスチェックAPI**: サービス状態とDB/Redis接続状態を返却
- ✅ **Swagger/OpenAPI仕様書自動生成**: 開発環境でのインタラクティブなAPIドキュメント（/docs）
- ✅ **PostgreSQLデータベース統合**: Prisma ORMによる型安全なデータアクセス
- ✅ **Redisキャッシング準備**: ioredisクライアント統合
- ✅ **Sentry統合（エラー監視）**: Backend/Frontendでのエラートラッキング
- ✅ **E2Eテスト環境（Playwright）**: TypeScriptによるブラウザ自動化テスト
- ✅ **ユーザー認証・認可**: JWT認証（EdDSA署名）によるセキュアなアクセス制御
  - 招待制ユーザー登録（招待トークン、メール送信、Bull非同期キュー）
  - ロールベースアクセス制御（RBAC: 動的ロール・権限管理、キャッシング）
  - JWT認証フロー（EdDSA署名、アクセス/リフレッシュトークン）
  - マルチデバイスセッション管理（デバイス情報、有効期限延長）
  - 2FA（TOTP + バックアップコード、QRコード生成、バックアップコード再生成、アカウントロックアウト）
  - パスワードリセット（トークンベース）
  - HTTPOnly Cookieによるリフレッシュトークン保護
  - 監査ログ（ユーザー行動記録、自動アーカイブ）
  - センシティブ操作アラート（システム管理者ロール変更通知）
- ✅ **共通ナビゲーション（AppHeader）**: 認証状態対応のアプリケーションヘッダー、レスポンシブメニュー、ユーザードロップダウン
- ✅ **ダッシュボード**: ログイン後のランディングページ
- ✅ **ロール管理ページ**: 管理者向けロールCRUD
- ✅ **権限管理ページ**: 管理者向け権限CRUD
- ✅ **プロジェクト管理機能**: プロジェクトCRUD、ステータス遷移管理、担当者割り当て、検索・フィルタリング、ページネーション
- ✅ **取引先管理機能**: 顧客・協力業者のCRUD、種別管理（顧客/協力業者の複数選択）、請求締日・支払日管理、検索・フィルタリング、ページネーション
- ✅ **現場調査機能**: プロジェクトに紐付く現場調査のCRUD、画像アップロード・管理（ストレージ抽象化レイヤー経由）、Canvas注釈編集（Fabric.js: 寸法線・矢印・円・四角形・多角形・折れ線・フリーハンド・テキスト）、PDF報告書エクスポート（jsPDF）、Undo/Redo、自動保存
- 🚧 **数量表作成機能**: 現場調査結果に基づく数量拾い出し、数量グループ・項目管理、計算方法選択（標準・面積体積・ピッチ）、調整係数・丸め設定、オートコンプリート入力支援

### 開発予定
- 🚧 **ADR作成・編集・削除**: アーキテクチャ決定記録のCRUD操作
- 🚧 **ADRバージョン管理**: 決定の履歴と変更追跡
- 🚧 **ADR検索・フィルタリング**: 高度な検索とタグベースのフィルタリング
- 🚧 **Markdown エディタ**: リアルタイムプレビュー付きエディタ
- 🚧 **ADRテンプレート管理**: カスタマイズ可能な決定記録テンプレート

### 開発ワークフロー機能

- **ステアリングドキュメント管理**: プロジェクト全体のルールとコンテキストを`.kiro/steering/`で管理
- **スペック駆動開発ワークフロー**: 要件定義 → 設計 → タスク分解 → 実装のフェーズ管理
- **カスタムスラッシュコマンド**: `/kiro:spec-init`, `/kiro:spec-requirements`, `/kiro:spec-design`など、開発プロセスを支援するコマンド群
- **進捗追跡**: `/kiro:spec-status`による仕様の進捗確認
- **バリデーション機能**: 設計品質レビューとギャップ分析

### 技術基盤機能

- **フロントエンド・バックエンド分離構造**: スケーラブルなアーキテクチャ設計
- **マルチサービスアーキテクチャ**: PostgreSQL、Redis統合による堅牢なデータ層
- **マルチ環境Docker開発基盤**: 開発/テスト/CI/デバッグ環境の分離、ポートオフセットによる同時実行、Node.jsデバッグサポート、初期管理者アカウント設定、高速起動（45-60秒から10-15秒に短縮）
- **ヘルスチェック機能**: 全サービス（PostgreSQL、Redis、Backend、Frontend）でヘルスチェックを実装し、起動順序と依存関係を保証
- **TypeScript完全サポート**: Backend、Frontend、E2Eテスト全体でTypeScript採用、厳格な型安全性を実現
- **型安全性の徹底**: カスタム型定義ファイル（Express拡張、環境変数）による`any`型の完全排除
- **Prisma 7 ORM統合**: PostgreSQLとの型安全なデータアクセスを実現、Driver Adapter Patternによる接続管理、マイグレーション管理とスキーマ駆動開発をサポート

### 品質保証機能

- **自動品質保証**: Git hooks（pre-commit、commit-msg、pre-push）による型チェック・lint・format check・テスト実行の強制
- **Conventional Commits強制**: commitlintによるコミットメッセージ規約の厳格な適用
- **同期テスト実行**: すべてのテスト（単体・統合・E2E）を同期実行し、完了を待ってから次の処理へ進行（Shift-Left原則）
- **タイムアウト保護**: E2Eテストに10分（Git hooks）/30分（CI/CD）のタイムアウト設定でハングアップを防止
- **包括的なテスト環境**:
  - **単体テスト**: Vitest + supertest/React Testing Library（**Backend 1800+テストケース、ブランチカバレッジ80%達成✅**、Frontend 700+テストケース）
  - **要件カバレッジチェック**: 仕様に基づく100%テストカバレッジ検証（E2Eテスト）
  - **統合テスト**: Backend 68テスト（API統合、データベース、認証フロー）
  - **E2Eテスト**: Playwright + TypeScriptによるブラウザ自動化テスト、タイムスタンプ付き結果管理
  - **負荷テスト**: Autocannon 8.0.0による高性能パフォーマンステスト、メトリクス記録機能
- **TypeScript Incremental Build**: 型チェック速度を34%向上（3.2秒 → 2.1秒）

### ドキュメント機能

- **Claude Code統合テスト**: AIアシスタントから直接ブラウザ操作・スクリーンショット撮影が可能
- **API自動ドキュメント生成**: OpenAPI 3.0/Swaggerによる開発環境でのインタラクティブなAPIドキュメント（/docs）
- **コンポーネントドキュメント**: Storybook 10.xによる視覚的なコンポーネントライブラリとデザインシステム
- **包括的なREADME**: プロジェクトバッジ、目次、アーキテクチャ図、テスト戦略、コントリビューションガイドを含む充実したドキュメント
- **Divioドキュメントシステム**: `docs/`ディレクトリを4分類で再編成
  - `getting-started/`: チュートリアル（学習指向）
  - `development/`: 開発ガイド（タスク指向）
  - `deployment/`: デプロイメントガイド
  - `architecture/`: アーキテクチャドキュメント（理解指向）
  - `api/`: APIリファレンス（情報指向）
  - `contributing/`: コントリビューションガイド

### アクセシビリティ機能

- **自動アクセシビリティテスト**: axe-playwright ^2.0.3による自動化されたa11yテスト
- **Storybook a11yアドオン**: Storybook 10.x統合によるコンポーネント開発時のアクセシビリティチェック
- **アクセシビリティユーティリティ**: `frontend/src/utils/accessibility.ts`による共通アクセシビリティ機能

### CI/CD機能

- **自動依存関係管理**: Dependabotによる週次セキュリティ更新と自動マージ（5エコシステム、85依存関係）
- **本番環境デプロイ**: Railwayプラットフォームによる継続的デプロイ（staging/productionサポート）
  - Prismaマイグレーション自動適用
  - HTTPS強制リダイレクトとヘルスチェック統合（HTTPSリダイレクト対応）
  - CI失敗時のCD自動スキップ
  - コンテナ環境対応（0.0.0.0リスンによる外部アクセス許可）
- **統合CI/CDパイプライン**: CIワークフロー内にデプロイジョブを統合、ci完了後にcdを自動実行
- **最適化されたCI/CD**: Matrix strategyによる並列実行、5ジョブ構成、Codecov連携
- **開発者体験の向上**: pre-pushフック実行時のDocker環境自動構築により、手動セットアップ不要

## ターゲットユースケース

### 主要な利用シーン

1. **新機能開発**: 要件定義から実装までの体系的な管理
2. **プロジェクト初期セットアップ**: ステアリングドキュメントによる方向性の明確化
3. **チーム開発**: 共通理解を促進する明確な仕様書管理
4. **品質管理**: 設計レビューとタスク進捗の可視化

### 適用場面

- 複雑な機能の段階的な実装が必要な場合
- 複数の開発者が関わるプロジェクトで共通理解が必要な場合
- 仕様変更の追跡と管理が重要な場合
- AIアシスタントと協調した開発を行う場合

## 主要な価値提案

### 明確な開発プロセス

3フェーズの承認ワークフロー（要件 → 設計 → タスク）により、各段階での人間のレビューを保証し、実装前の問題発見を促進します。

### コンテキストの一貫性

ステアリングドキュメント（product.md、tech.md、structure.md）により、AIアシスタントが常に最新のプロジェクト情報を参照し、一貫性のある提案を行います。

### 段階的な実装管理

大規模な機能を小さなタスクに分解し、進捗を可視化することで、プロジェクトの見通しを改善します。

### 柔軟なカスタマイズ

カスタムステアリングファイルとスラッシュコマンドにより、プロジェクト固有のワークフローに対応できます。
